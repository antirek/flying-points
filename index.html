<!DOCTYPE html>
<html>
<head>
    <script src="bower_components/konva/konva.min.js"></script>
    <script src="index.js"></script>
    <meta charset="utf-8">
    <title>Flying points demo</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            overflow: hidden;
            background-color: #F0F0F0;
        }
    </style>
</head>
<body>
<div id="container"></div>

<script>

    var Stage = function (container) {
        var width = window.innerWidth;
        var height = window.innerHeight;

        var stage = new Konva.Stage({
            container: container,
            width: width,
            height: height
        });

        var layer = new Konva.Layer();
        stage.add(layer);

        var add = function (x, y, vx, vy, color) {
            var q = {};

            q.hexagon = new Konva.Circle({
                x: x,
                y: y,                
                radius: 10,
                fill: color
            });

            layer.add(q.hexagon);
            
            q.anim = new Konva.Animation(function (frame) {
                var x = q.hexagon.x();
                var y = q.hexagon.y();
                if (x > width || x < 0) {
                    vx = -vx
                }
                if (y > height || y < 0) {
                    vy = -vy
                }
                q.hexagon.setX(x + vx);
                q.hexagon.setY(y + vy);
            }, layer);
            
            q.anim.start();

            return q;
        };

        var remove = function (obj) {
            layer.remove(obj.hexagon);
        }

        return {
            add: add,
            remove: remove
        };
    };
    
    var stage = new Stage('container');

    var q1 = stage.add(50, 50, 5, -5, 'red');
    stage.add(50, 50, 10, -10, 'green');
    stage.add(250, 250, 10, -10, 'blue');

    setTimeout(function () {
        q1.anim.stop();
        q1.hexagon.remove();
        //stage.remove(q1);
    }, 10000);

</script>
</body>
</html>